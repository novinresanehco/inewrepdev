function displayDefaultResults(){var n=$("#cablecalc-form");$.ajax({url:"umbraco/surface/cablecalculator/getdefaultresults",type:"POST",data:n.serialize(),success:function(n){displayResults(n);$resultContainer.removeClass("active-results").addClass("default-results")},error:function(n,t,i){console.log(n,t,i)}})}function displayResults(n){var t,i,r,u,f;if($resultContainer.empty(),n&&n.Results&&n.Results.length>0)for(t=0;t<n.Results.length;t++){i=$resultTemplate.clone();r=n.Results[t];r.Suitable&&i.addClass("suitable");for(u in r)f=".result-"+u.toLowerCase(),i.find(f).html(r[u]);$resultContainer.append(i)}$("div.boxed a").click(function(n){return n.stopPropagation(),$(this).closest(".row").hasClass("suitable")?void 0:!1});$("div.boxed").click(function(){$(this).closest(".row").hasClass("suitable")&&!$(this).hasClass("doNotFastQuote")&&(document.location.href=$(this).find("a").attr("href"))})}function disableFields(){for(var t,n=currentDropDown+1;n<ddOrder.length;n++)t=$("#"+ddOrder[n]),t.prop("disabled",!0),ddOrder[n]!="voltage"?t.empty():(t.val(""),t.find("option:first-child").text(""))}function populateDrownDown(n,t,i,r){var u=$("#"+n),f;u.empty();u.val("");i===!0&&u.append($("<option><\/option>").attr("value","").text(pleaseSelectText));$.each(t,function(n,t){if(t=="")u.append($("<option><\/option>").attr("value","Not Set").text(t));else{var i=t.split("|");u.append($("<option><\/option>").attr("value",i[1]).html(i[0]+"&nbsp;&nbsp;"))}});r&&r.length>0?u.val(r):t.length==1&&i&&(f=t[0].split("|"),u.val(f[1]),u.trigger("change"))}var currentDropDown=0,ddOrder=["standard","conductor","phase","voltage","installationmethod","configuration","format"],pleaseSelectText="Please select",$resultTemplate=null,$resultContainer=null;$(document).ready(function(){var e=$("body"),o=e.attr("data-lang"),r=$("#standard"),s=$("#load"),h=$("#length"),c=$(".cable-calc-btn-reset[type=reset]"),n=$("#cablecalc-form"),t=$("#voltage"),i=$("#phase"),u,f;for(disableFields(),pleaseSelectText=n.attr("data-lang-please-select"),$("select.calc-filter-next",n).change(function(){var u=$(this),f=u.attr("id");currentDropDown=ddOrder.indexOf(f);ddOrder[currentDropDown]=="phase"&&(currentDropDown++,t.val("230"),i.val().toLowerCase().indexOf("three")!=-1&&t.val("415"));disableFields();r.val()!==""&&currentDropDown<ddOrder.length-1&&$.ajax({url:"umbraco/surface/cablecalculator/getfiltereddropdowns",type:"POST",data:n.serialize(),success:function(n){for(var r=ddOrder[currentDropDown],f,e,o,u=currentDropDown+1;u<ddOrder.length;u++)if(r=ddOrder[u],n[r])break;n[r]&&(populateDrownDown(r,n[r],!0,""),f=$("#"+r),f.prop("disabled",!1),f.focus(),e=i.prop("disabled"),o=t.prop("disabled"),!e&&o&&t.find("option:first-child").text(pleaseSelectText),t.prop("disabled",e))},error:function(n,t,i){console.log(n,t,i)}})}),t.change(function(){t.val()=="415"?i.find("option[value^=Three]").prop("selected",!0):i.find("option[value^=Single]").prop("selected",!0);i.change()}),$resultTemplate=$("#result-row-template").clone().removeAttr("id").attr("class","row"),$resultContainer=$("#result-rows-container"),u=0;u<7;u++)$resultContainer.append($resultTemplate.clone().contents());f=function(n){var t=window.scrollX,i=window.scrollY;window.innerWidth>700&&n.focus({preventScroll:!0});window.scrollTo(t,i)};f(document.getElementById("standard"));r.change(function(){displayDefaultResults()}).change();$("#reset-btn").click(function(){r.val("").change()});$("#load, #length, #unitofmeasurement").change(function(){$resultContainer.hasClass("default-results")||displayDefaultResults()});n.submit(function(t){return t.stopPropagation(),t.preventDefault(),n.valid()&&$.ajax({url:"umbraco/surface/cablecalculator/getresults",type:"POST",data:n.serialize(),success:function(n){displayResults(n);$resultContainer.removeClass("default-results").addClass("active-results")},error:function(n,t,i){console.log(n,t,i)}}),!1});$("#downloadresults").click(function(t){if(t.stopPropagation(),t.preventDefault(),n.valid()){var i=new XMLHttpRequest;i.open("POST","umbraco/surface/cablecalculator/getresultsdebug",!0);i.responseType="arraybuffer";i.onload=function(){var n,f,h,e,o,r,s,u,t;if(this.status===200){if(n="",f=i.getResponseHeader("Content-Disposition"),f&&f.indexOf("attachment")!==-1&&(h=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/,e=h.exec(f),e!=null&&e[1]&&(n=e[1].replace(/['"]/g,""))),o=i.getResponseHeader("Content-Type"),typeof File=="function")try{r=new File([this.response],n,{type:o})}catch(c){}typeof r=="undefined"&&(r=new Blob([this.response],{type:o}));typeof window.navigator.msSaveBlob!="undefined"?window.navigator.msSaveBlob(r,n):(s=window.URL||window.webkitURL,u=s.createObjectURL(r),n?(t=document.createElement("a"),typeof t.download=="undefined"?window.location=u:(t.href=u,t.download=n,document.body.appendChild(t),t.click())):window.location=u,setTimeout(function(){s.revokeObjectURL(u)},100))}};i.setRequestHeader("Content-type","application/x-www-form-urlencoded");i.send(n.serialize())}return!1});n.validate()})